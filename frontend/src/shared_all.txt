==== C:\dev\AMS_HoldCrypto\frontend\src\shared\api\api.ts ====
// Caminho: frontend/src/shared/api/api.ts

const crudAPI = (basePath: string) => ({
  create: () => `${basePath}`,
  getAll: () => `${basePath}`,
  getById: (id: string | number) => `${basePath}/${id}`,
  update: (id: string | number) => `${basePath}/${id}`,
  delete: (id: string | number) => `${basePath}/${id}`,
});

// As rotas aqui DEVEM corresponder exatamente ao 'UpstreamPathTemplate' do ocelot.json
export const userAPI = crudAPI(`/user`);
export const currencyAPI = crudAPI(`/currency`);
export const authAPI = {
  login: () => `/auth/login`,
  getProfile: () => `/auth/profile`,
};

// Definições para a Wallet API
export const walletAPI = {
  // GET /wallet?userId={userId}
  getUserWallets: (userId: number) => `/wallet?userId=${userId}`,
  // POST /wallet
  createWallet: () => `/wallet`,
  // POST /wallet/{id}/deposit
  deposit: (walletId: number) => `/wallet/${walletId}/deposit`,
  // POST /wallet/{id}/withdraw
  withdraw: (walletId: number) => `/wallet/${walletId}/withdraw`,
  // POST /wallet/transfer (transferência simples)
  transfer: () => `/wallet/transfer`,

  // ****** NOVA ROTA ADICIONADA ******
  // POST /wallet/trade (troca/swap de moedas)
  trade: () => `/wallet/trade`,
  // **********************************
};

---- end of file ----

==== C:\dev\AMS_HoldCrypto\frontend\src\shared\api\apiClient.ts ====
// Caminho: frontend/src/shared/api/apiClient.ts

import axios from 'axios';
// 1. Importar o store diretamente (NÃO o hook)
import { useAuthStore } from '@/features/auth/store/useAuthStore'; // Ajuste o caminho se necessário

// 2. Definimos a URL base do seu Gateway API.
const API_BASE_URL = 'http://localhost:5026';

// 3. Criamos a instância do axios.
const apiClient = axios.create({
  baseURL: API_BASE_URL,
  headers: {
    'Content-Type': 'application/json',
  },
});

// 4. Interceptor de REQUISIÇÃO (Este você já tinha)
// Adiciona o token JWT em TODAS as requisições
apiClient.interceptors.request.use(
  (config) => {
    // Pega o token diretamente do store Zustand ou do localStorage
    // Usar o store é melhor caso o token seja atualizado em memória
    const token = useAuthStore.getState().token || (typeof window !== 'undefined' ? localStorage.getItem('token') : null);
    
    if (token) {
      config.headers.Authorization = `Bearer ${token}`;
    }
    return config;
  },
  (error) => {
    return Promise.reject(error);
  }
);

// 5. NOVO: Interceptor de RESPOSTA (A Solução para o 401)
// Observa todas as respostas que chegam da API
apiClient.interceptors.response.use(
  (response) => {
    // Se a resposta for 2xx (Sucesso), apenas a repassa
    return response;
  },
  (error) => {
    // Se a API retornar um erro
    const { response } = error;

    // Verifica se o erro é um 401 (Não Autorizado / Token Expirado)
    if (response && response.status === 401) {
      console.warn("apiClient Interceptor: Erro 401 (Não Autorizado) detetado. Token expirado ou inválido. Executando logout...");

      // Pega a ação de logout DIRETAMENTE do store (não podemos usar hooks aqui)
      const { logout } = useAuthStore.getState().actions;
      
      // Chama a ação de logout
      // Isso limpará o token do localStorage e resetará o estado do Zustand
      logout();

      // Redireciona o usuário para a página de login
      if (typeof window !== 'undefined') {
        // Usamos replace para não adicionar a página "morta" ao histórico do navegador
        // Verificamos se já não estamos no login para evitar loops
        if (window.location.pathname !== '/login') {
          window.location.replace('/login?sessionExpired=true'); // Adiciona um parâmetro (opcional)
        }
      }
    }

    // Repassa o erro original para que a função que fez a chamada (ex: o handleSubmit)
    // ainda possa recebê-lo e tratar (ex: parar o loading, mostrar notificação)
    return Promise.reject(error);
  }
);

export default apiClient;

---- end of file ----

==== C:\dev\AMS_HoldCrypto\frontend\src\shared\components\AppLayout.tsx ====
'use client';
import { useState, useEffect, useMemo } from 'react';
import { 
    Box, Drawer, List, ListItem, ListItemButton, ListItemIcon, ListItemText, 
    useMediaQuery, IconButton, Avatar
} from '@mui/material';
import { LayoutDashboard, Users, LineChart, Menu as MenuIcon, LogOut, UserCircle } from 'lucide-react'; 
import { usePathname, useRouter } from 'next/navigation';
import { useAuthUser, useIsAuthenticated, useAuthLoading, useAuthActions } from '@/features/auth/store/useAuthStore';

const drawerWidth = 260;

export const AppLayout = ({ children }: { children: React.ReactNode }) => {
    const router = useRouter();
    const pathname = usePathname();
    const isMobile = useMediaQuery('(max-width:900px)');
    const [mobileOpen, setMobileOpen] = useState(false);

    const { fetchProfile, logout } = useAuthActions();
    const user = useAuthUser();
    const isAuthenticated = useIsAuthenticated();
    const isLoadingAuth = useAuthLoading();

    const navItems = useMemo(() => {
        const items = [
            { text: 'Visão Geral', href: '/dashboard', icon: LayoutDashboard },
            { text: 'Mercados', href: '/currency', icon: LineChart },
        ];
        if (user?.role === 'admin') {
            items.push({ text: 'Usuários', href: '/users', icon: Users });
        }
        items.push({ text: 'Meu Perfil', href: '/profile', icon: UserCircle });
        return items;
    }, [user]);

    useEffect(() => {
        fetchProfile();
    }, [fetchProfile]);

    useEffect(() => {
        if (!isLoadingAuth && !isAuthenticated) {
            router.push('/login');
        }
    }, [isLoadingAuth, isAuthenticated, router]);

    const handleDrawerToggle = () => {
        setMobileOpen(!mobileOpen);
    };

    if (isLoadingAuth) {
        return (
            <div className="flex h-screen w-full items-center justify-center bg-[#020617]">
                <div className="flex flex-col items-center gap-4">
                    <div className="h-10 w-10 animate-spin rounded-full border-4 border-yellow-500 border-t-transparent"></div>
                    <span className="text-yellow-500 font-mono text-sm">CARREGANDO SISTEMA...</span>
                </div>
            </div>
        );
    }

    if (!isAuthenticated) return null;

    const drawerContent = (
        <div className="h-full flex flex-col bg-[#0f172a]/95 backdrop-blur-xl border-r border-white/5 text-white">
            <div className="p-6 flex items-center gap-3 border-b border-white/5">
                <div className="flex h-10 w-10 items-center justify-center rounded-xl bg-yellow-500 text-black font-bold text-2xl shadow-[0_0_20px_rgba(240,185,11,0.4)]">H</div>
                <div>
                    <h1 className="text-lg font-bold tracking-tight text-white leading-tight">HoldCrypto</h1>
                    <p className="text-[10px] text-gray-400 font-mono uppercase tracking-widest">Pro Terminal</p>
                </div>
            </div>
            <div className="flex-1 overflow-y-auto py-6 px-3">
                <List>
                    {navItems.map((item) => {
                        const isActive = pathname === item.href;
                        return (
                            <ListItem key={item.text} disablePadding sx={{ mb: 1 }}>
                                <ListItemButton
                                    onClick={() => { router.push(item.href); if (isMobile) handleDrawerToggle(); }}
                                    sx={{
                                        borderRadius: '12px', py: 1.5, px: 2,
                                        bgcolor: isActive ? 'rgba(240, 185, 11, 0.15)' : 'transparent',
                                        border: '1px solid', borderColor: isActive ? 'rgba(240, 185, 11, 0.3)' : 'transparent',
                                        color: isActive ? '#F0B90B' : '#94a3b8',
                                        transition: 'all 0.2s ease',
                                        '&:hover': { bgcolor: 'rgba(255, 255, 255, 0.03)', color: '#fff', transform: 'translateX(4px)' }
                                    }}
                                >
                                    <ListItemIcon sx={{ minWidth: 40, color: 'inherit' }}><item.icon size={20} /></ListItemIcon>
                                    <ListItemText primary={item.text} primaryTypographyProps={{ fontSize: '0.9rem', fontWeight: isActive ? 600 : 500, fontFamily: 'inherit' }} />
                                    {isActive && <div className="h-2 w-2 rounded-full bg-yellow-500 shadow-[0_0_10px_#F0B90B]"></div>}
                                </ListItemButton>
                            </ListItem>
                        );
                    })}
                </List>
            </div>
            <div className="p-4 border-t border-white/5 bg-black/20">
                <div className="flex items-center gap-3 mb-4 p-3 rounded-xl bg-white/5 border border-white/5 cursor-pointer hover:bg-white/10 transition-colors" onClick={() => router.push('/profile')}>
                    <Avatar src={user?.photo || undefined} sx={{ bgcolor: '#F0B90B', color: '#000', width: 36, height: 36, fontWeight: 'bold' }}>{user?.name?.charAt(0) || 'U'}</Avatar>
                    <div className="overflow-hidden">
                        <p className="text-sm font-bold text-white truncate">{user?.name}</p>
                        <div className="flex items-center gap-2"><span className="text-[10px] uppercase tracking-wider text-gray-500">{user?.role === 'admin' ? 'Administrador' : 'Usuário'}</span></div>
                    </div>
                </div>
                <button onClick={() => logout()} className="w-full flex items-center justify-center gap-2 py-2.5 rounded-lg text-xs font-bold uppercase tracking-wider text-red-400 hover:bg-red-500/10 hover:text-red-300 transition-all border border-transparent hover:border-red-500/20">
                    <LogOut size={16} /> Encerrar Sessão
                </button>
            </div>
        </div>
    );

    return (
        <Box sx={{ display: 'flex', minHeight: '100vh', bgcolor: 'transparent' }}>
            {isMobile && (
                <div className="fixed top-0 left-0 right-0 z-50 flex h-16 items-center justify-between border-b border-white/10 bg-[#0f172a]/80 px-4 backdrop-blur-md">
                    <div className="flex items-center gap-2"><div className="flex h-8 w-8 items-center justify-center rounded bg-yellow-500 text-black font-bold">H</div><span className="font-bold text-white">HoldCrypto</span></div>
                    <IconButton onClick={handleDrawerToggle} sx={{ color: 'white' }}><MenuIcon /></IconButton>
                </div>
            )}
            <Box component="nav" sx={{ width: { md: drawerWidth }, flexShrink: { md: 0 } }}>
                <Drawer variant="temporary" open={mobileOpen} onClose={handleDrawerToggle} ModalProps={{ keepMounted: true }} sx={{ display: { xs: 'block', md: 'none' }, '& .MuiDrawer-paper': { boxSizing: 'border-box', width: drawerWidth, bgcolor: 'transparent', border: 'none' } }}>{drawerContent}</Drawer>
                <Drawer variant="permanent" sx={{ display: { xs: 'none', md: 'block' }, '& .MuiDrawer-paper': { boxSizing: 'border-box', width: drawerWidth, bgcolor: 'transparent', border: 'none' } }} open>{drawerContent}</Drawer>
            </Box>
            <Box component="main" sx={{ flexGrow: 1, p: { xs: 2, md: 4 }, width: { md: `calc(100% - ${drawerWidth}px)` }, mt: { xs: 8, md: 0 }, overflowX: 'hidden' }}>{children}</Box>
        </Box>
    );
};

---- end of file ----

==== C:\dev\AMS_HoldCrypto\frontend\src\shared\components\AuthInitializer.tsx ====
// Caminho: frontend/src/shared/components/AuthInitializer.tsx
'use client';

import { useEffect } from 'react';
import { useAuthActions } from '@/features/auth/store/useAuthStore'; // Ajuste o caminho se necessário

// Este componente não renderiza nada visualmente,
// ele apenas executa a lógica de verificação de auth uma vez.
export function AuthInitializer({ children }: { children: React.ReactNode }) {
  const { fetchProfile } = useAuthActions();

  useEffect(() => {
    console.log("AuthInitializer: Running initial auth check...");
    fetchProfile();
  // eslint-disable-next-line react-hooks/exhaustive-deps
  }, []); // Executa apenas uma vez quando o app carrega

  return <>{children}</>; // Renderiza os filhos normalmente
}

---- end of file ----

==== C:\dev\AMS_HoldCrypto\frontend\src\shared\components\ChartBox.tsx ====
'use client';
import React, { useState } from 'react';
import { Box, Typography, Button, useTheme, Paper, ButtonGroup } from '@mui/material';
import { AreaChart, Area, XAxis, YAxis, Tooltip, ResponsiveContainer, Legend } from 'recharts';

// Tipagem para os dados do gráfico
type PeriodKey = 'week' | 'month' | 'year';
interface BalanceData {
  name: string;
  Balance: number;
  Income: number;
  Outcome: number;
}

// Dados simulados para diferentes períodos, focados em balanço
const chartData: Record<PeriodKey, BalanceData[]> = {
  week: [
    { name: 'Seg', Income: 400, Outcome: 240, Balance: 160 },
    { name: 'Ter', Income: 300, Outcome: 139, Balance: 161 },
    { name: 'Qua', Income: 200, Outcome: 980, Balance: -780 },
    { name: 'Qui', Income: 278, Outcome: 390, Balance: -112 },
    { name: 'Sex', Income: 189, Outcome: 480, Balance: -291 },
  ],
  month: [
    { name: 'Sem 1', Income: 1400, Outcome: 400, Balance: 1000 },
    { name: 'Sem 2', Income: 1500, Outcome: 1000, Balance: 500 },
    { name: 'Sem 3', Income: 1200, Outcome: 1800, Balance: -600 },
    { name: 'Sem 4', Income: 2000, Outcome: 500, Balance: 1500 },
  ],
  year: [
    { name: 'Jan', Income: 4000, Outcome: 2400, Balance: 1600 },
    { name: 'Fev', Income: 3000, Outcome: 1398, Balance: 1602 },
    { name: 'Mar', Income: 2000, Outcome: 9800, Balance: -7800 },
    { name: 'Abr', Income: 2780, Outcome: 3908, Balance: -1128 },
    { name: 'Mai', Income: 1890, Outcome: 4800, Balance: -2910 },
    { name: 'Jun', Income: 2390, Outcome: 3800, Balance: -1410 },
  ],
};

const periods: { label: string; key: PeriodKey }[] = [
  { label: "Semana", key: "week" },
  { label: "Mês", key: "month" },
  { label: "Ano", key: "year" },
];

export default function ChartBox() {
  const [selectedPeriod, setSelectedPeriod] = useState<PeriodKey>("year");
  const theme = useTheme();
  const data = chartData[selectedPeriod];

  return (
    <Paper 
        sx={{ 
            p: 3, 
            bgcolor: 'background.paper', 
            borderRadius: 4, 
            height: '100%',
            display: 'flex',
            flexDirection: 'column'
        }}
    >
      <Box display="flex" justifyContent="space-between" alignItems="center" mb={2}>
        <Typography variant="h6" fontWeight="bold">
          Overview
        </Typography>
        <ButtonGroup variant="outlined" size="small">
            {periods.map((p) => (
                <Button
                    key={p.key}
                    onClick={() => setSelectedPeriod(p.key)}
                    sx={{
                        color: selectedPeriod === p.key ? '#0B0B0B' : 'primary.main',
                        backgroundColor: selectedPeriod === p.key ? 'primary.main' : 'transparent',
                        borderColor: 'primary.main',
                        '&:hover': {
                            backgroundColor: 'primary.main',
                            color: '#0B0B0B',
                            opacity: 0.9
                        }
                    }}
                >
                    {p.label}
                </Button>
            ))}
        </ButtonGroup>
      </Box>
      <Box flex={1} minHeight={300}>
        <ResponsiveContainer width="100%" height="100%">
          <AreaChart data={data} margin={{ top: 10, right: 30, left: 0, bottom: 0 }}>
             <defs>
                <linearGradient id="colorBalance" x1="0" y1="0" x2="0" y2="1">
                <stop offset="5%" stopColor={theme.palette.primary.main} stopOpacity={0.8}/>
                <stop offset="95%" stopColor={theme.palette.primary.main} stopOpacity={0}/>
                </linearGradient>
            </defs>
            <XAxis dataKey="name" stroke={theme.palette.text.secondary} fontSize={12} />
            <YAxis stroke={theme.palette.text.secondary} fontSize={12} />
            <Tooltip
              contentStyle={{ 
                  backgroundColor: 'rgba(30, 30, 30, 0.8)', 
                  borderColor: theme.palette.divider,
                  borderRadius: theme.shape.borderRadius
              }}
              labelStyle={{ color: theme.palette.primary.main, fontWeight: 'bold' }}
            />
            <Legend wrapperStyle={{ fontSize: '14px' }} />
            <Area 
                type="monotone" 
                dataKey="Balance" 
                stroke={theme.palette.primary.main} 
                strokeWidth={2}
                fillOpacity={1} 
                fill="url(#colorBalance)" 
            />
          </AreaChart>
        </ResponsiveContainer>
      </Box>
    </Paper>
  );
}



---- end of file ----

==== C:\dev\AMS_HoldCrypto\frontend\src\shared\components\CoinHighlight.tsx ====
'use client';
import React from 'react';
import { Box, Typography, Paper, Avatar, useTheme } from '@mui/material';

export interface CoinHighlightProps {
  name: string;
  symbol: string;
  price: number;
  change: number;
}

// 1. Adicionamos a mesma função de formatação da Dashboard aqui
const formatCurrencyValue = (value: number) => {
    if (value >= 1_000_000_000) return `${(value / 1_000_000_000).toFixed(2)}B`;
    if (value >= 1_000_000) return `${(value / 1_000_000).toFixed(2)}M`;
    if (value >= 1_000) return `${(value / 1_000).toFixed(2)}K`;
    // Para valores menores, usamos a formatação completa para precisão
    return value.toLocaleString('pt-BR', { minimumFractionDigits: 2, maximumFractionDigits: 2 });
};

const getSymbolColor = (symbol: string) => {
  const colors = ['#F0B90B', '#627EEA', '#26A17B', '#F3BA2F', '#8A2BE2', '#4F4F4F', '#f0f0f0'];
  let hash = 0;
  for (let i = 0; i < symbol.length; i++) {
    hash = symbol.charCodeAt(i) + ((hash << 5) - hash);
  }
  return colors[Math.abs(hash) % colors.length];
};

const CoinHighlight: React.FC<CoinHighlightProps> = ({ name, symbol, price, change }) => {
  const theme = useTheme();
  const isPositive = change >= 0;

  return (
    <Paper
      sx={{
        p: 3,
        bgcolor: 'background.paper',
        borderRadius: 4,
        border: `1px solid ${theme.palette.divider}`,
        height: '100%',
        display: 'flex',
        flexDirection: 'column',
        justifyContent: 'space-between',
        transition: 'transform 0.2s, box-shadow 0.2s',
        '&:hover': {
          transform: 'translateY(-4px)',
          boxShadow: `0 8px 24px ${theme.palette.primary.main}20`,
        },
      }}
    >
      <Box display="flex" alignItems="center" mb={2}>
        <Avatar sx={{ bgcolor: getSymbolColor(symbol), width: 40, height: 40, mr: 2, color: '#0B0B0B', fontWeight: 'bold' }}>
          {symbol.charAt(0)}
        </Avatar>
        <Box>
          <Typography variant="h6" fontWeight="bold">
            {name}
          </Typography>
          <Typography variant="body2" color="text.secondary">
            {symbol}
          </Typography>
        </Box>
      </Box>
      <Box>
        <Typography variant="h5" fontWeight="bold" textAlign="right">
          {/* 2. Aplicamos a formatação aqui */}
          R$ {formatCurrencyValue(price)}
        </Typography>
        <Typography
          textAlign="right"
          fontWeight="bold"
          sx={{ color: isPositive ? theme.palette.success.main : theme.palette.error.main }}
        >
          {isPositive ? '?' : '?'} {Math.abs(change).toFixed(2)}%
        </Typography>
      </Box>
    </Paper>
  );
};

export default CoinHighlight;



---- end of file ----

==== C:\dev\AMS_HoldCrypto\frontend\src\shared\components\Footer.tsx ====
'use client';
import React from 'react';
import Link from 'next/link';
import { Twitter, Instagram, Linkedin, Github, Mail } from 'lucide-react';

const footerLinks = {
  produto: [
    { name: 'Mercados', href: '/currency' },
    { name: 'Trade', href: '/dashboard' },
    { name: 'Taxas', href: '#' },
    { name: 'Segurança', href: '#' },
  ],
  suporte: [
    { name: 'Central de Ajuda', href: '#' },
    { name: 'Fale Conosco', href: '#' },
    { name: 'Status da API', href: '#' },
  ],
  legal: [
    { name: 'Termos de Uso', href: '#' },
    { name: 'Privacidade', href: '#' },
    { name: 'Compliance', href: '#' },
  ]
};

export default function Footer() {
  return (
    <footer className="border-t border-white/10 bg-[#0f172a]/30 backdrop-blur-md mt-auto">
      <div className="max-w-7xl mx-auto px-6 pt-16 pb-8">
        
        <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-12 mb-12">
          {/* Coluna 1: Marca */}
          <div className="space-y-4">
            <div className="flex items-center gap-2">
              <div className="flex h-8 w-8 items-center justify-center rounded-lg bg-yellow-500 text-black font-bold text-xl">
                H
              </div>
              <span className="text-xl font-bold tracking-tight text-white">
                HoldCrypto
              </span>
            </div>
            <p className="text-gray-400 text-sm leading-relaxed">
              A plataforma de ativos digitais mais confiável para traders e investidores institucionais.
            </p>
            <div className="flex gap-4 pt-2">
              <SocialLink icon={Twitter} href="#" />
              <SocialLink icon={Instagram} href="#" />
              <SocialLink icon={Linkedin} href="#" />
              <SocialLink icon={Github} href="#" />
            </div>
          </div>

          {/* Coluna 2: Produto */}
          <div>
            <h3 className="font-bold text-white mb-4">Produto</h3>
            <ul className="space-y-2">
              {footerLinks.produto.map((link) => (
                <li key={link.name}>
                  <Link href={link.href} className="text-sm text-gray-400 hover:text-yellow-500 transition-colors">
                    {link.name}
                  </Link>
                </li>
              ))}
            </ul>
          </div>

          {/* Coluna 3: Suporte */}
          <div>
            <h3 className="font-bold text-white mb-4">Suporte</h3>
            <ul className="space-y-2">
              {footerLinks.suporte.map((link) => (
                <li key={link.name}>
                  <Link href={link.href} className="text-sm text-gray-400 hover:text-yellow-500 transition-colors">
                    {link.name}
                  </Link>
                </li>
              ))}
            </ul>
          </div>

          {/* Coluna 4: Newsletter (CTA) */}
          <div>
            <h3 className="font-bold text-white mb-4">Fique Atualizado</h3>
            <p className="text-xs text-gray-400 mb-4">Receba análises de mercado diárias.</p>
            <div className="relative">
              <Mail className="absolute left-3 top-3 text-gray-500" size={16} />
              <input 
                type="email" 
                placeholder="Seu melhor e-mail" 
                className="w-full bg-white/5 border border-white/10 rounded-lg py-2.5 pl-10 pr-4 text-sm text-white focus:outline-none focus:border-yellow-500/50 focus:ring-1 focus:ring-yellow-500/50 transition-all"
              />
            </div>
          </div>
        </div>

        {/* Rodapé Inferior */}
        <div className="border-t border-white/10 pt-8 flex flex-col md:flex-row justify-between items-center gap-4">
          <p className="text-xs text-gray-500">
            &copy; {new Date().getFullYear()} AMS HoldCrypto. Todos os direitos reservados.
          </p>
          <div className="flex gap-6 text-xs text-gray-500">
            <span className="flex items-center gap-2">
              <span className="w-2 h-2 rounded-full bg-emerald-500 animate-pulse"></span>
              Sistemas Operacionais
            </span>
          </div>
        </div>
      </div>
    </footer>
  );
}

// Componente auxiliar para ícones sociais
const SocialLink = ({ icon: Icon, href }: { icon: any, href: string }) => (
  <a 
    href={href} 
    className="p-2 rounded-full bg-white/5 text-gray-400 hover:bg-yellow-500 hover:text-black transition-all duration-300"
  >
    <Icon size={18} />
  </a>
);

---- end of file ----

==== C:\dev\AMS_HoldCrypto\frontend\src\shared\components\Header.tsx ====
'use client';
import React, { useState } from "react";
import { useRouter, usePathname } from "next/navigation";
import Link from "next/link";
import { useAuthUser, useIsAuthenticated, useAuthActions } from '@/features/auth/store/useAuthStore';
import { Menu, X, User, LogOut, Wallet, BarChart3, LayoutDashboard } from 'lucide-react'; // Ícones modernos

export default function Header() {
    const router = useRouter();
    const pathname = usePathname();
    const [isMobileMenuOpen, setIsMobileMenuOpen] = useState(false);
    
    const user = useAuthUser();
    const isAuthenticated = useIsAuthenticated();
    const { logout } = useAuthActions();

    const handleLogout = () => {
        logout();
        router.push("/login");
    };

    const navLinks = [
        { name: "Dashboard", href: "/dashboard", icon: LayoutDashboard },
        { name: "Mercados", href: "/currency", icon: BarChart3 },
        { name: "Usuários", href: "/users", icon: User }, // Só se for admin, mas deixamos aqui
    ];

    return (
        <header className="sticky top-0 z-50 w-full border-b border-white/10 bg-[#0f172a]/80 backdrop-blur-md">
            <div className="mx-auto flex h-16 max-w-7xl items-center justify-between px-6">
                
                {/* Logo & Marca */}
                <Link href="/" className="flex items-center gap-2 group">
                    <div className="flex h-8 w-8 items-center justify-center rounded-lg bg-yellow-500 text-black font-bold text-xl group-hover:shadow-[0_0_15px_rgba(240,185,11,0.6)] transition-all">
                        H
                    </div>
                    <span className="text-lg font-bold tracking-tight text-white group-hover:text-yellow-400 transition-colors">
                        HoldCrypto
                    </span>
                </Link>

                {/* Navegação Desktop (Estilo Clean) */}
                <nav className="hidden md:flex items-center gap-8">
                    {isAuthenticated && navLinks.map((link) => {
                        const isActive = pathname === link.href;
                        return (
                            <Link 
                                key={link.name} 
                                href={link.href}
                                className={`flex items-center gap-2 text-sm font-medium transition-colors ${isActive ? 'text-yellow-400' : 'text-gray-400 hover:text-white'}`}
                            >
                                <link.icon size={18} />
                                {link.name}
                            </Link>
                        )
                    })}
                </nav>

                {/* Área do Usuário (Estilo Pro) */}
                <div className="hidden md:flex items-center gap-4">
                    {isAuthenticated ? (
                        <div className="flex items-center gap-3 pl-4 border-l border-white/10">
                            <div className="text-right hidden lg:block">
                                <p className="text-xs text-gray-400">Logado como</p>
                                <p className="text-sm font-bold text-white leading-none">{user.name}</p>
                            </div>
                            <button 
                                onClick={handleLogout}
                                className="p-2 rounded-full hover:bg-white/5 text-gray-400 hover:text-red-400 transition-colors"
                                title="Sair"
                            >
                                <LogOut size={20} />
                            </button>
                        </div>
                    ) : (
                        <div className="flex gap-3">
                            <Link href="/login" className="px-4 py-2 text-sm font-bold text-white hover:text-yellow-400 transition-colors">
                                Entrar
                            </Link>
                            <Link href="/register" className="px-4 py-2 text-sm font-bold text-black bg-yellow-500 rounded-lg hover:bg-yellow-400 hover:shadow-[0_0_15px_rgba(240,185,11,0.4)] transition-all">
                                Criar Conta
                            </Link>
                        </div>
                    )}
                </div>

                {/* Mobile Menu Button */}
                <button className="md:hidden text-white" onClick={() => setIsMobileMenuOpen(!isMobileMenuOpen)}>
                    {isMobileMenuOpen ? <X /> : <Menu />}
                </button>
            </div>

            {/* Mobile Menu (Simples) */}
            {isMobileMenuOpen && (
                <div className="md:hidden border-t border-white/10 bg-[#0f172a] p-4 space-y-4">
                    {isAuthenticated && navLinks.map(link => (
                        <Link key={link.href} href={link.href} className="flex items-center gap-3 text-gray-300 py-2" onClick={() => setIsMobileMenuOpen(false)}>
                            <link.icon size={20} /> {link.name}
                        </Link>
                    ))}
                    {isAuthenticated && (
                        <button onClick={handleLogout} className="flex items-center gap-3 text-red-400 py-2 w-full text-left">
                            <LogOut size={20} /> Sair
                        </button>
                    )}
                </div>
            )}
        </header>
    );
}

---- end of file ----

==== C:\dev\AMS_HoldCrypto\frontend\src\shared\components\MainButton.tsx ====
'use client';
import React from "react";
import clsx from "clsx";

// 1. A interface de props agora inclui 'children' explicitamente.
interface MainButtonProps extends React.ButtonHTMLAttributes<HTMLButtonElement> {
  variant?: "primary" | "secondary";
  children: React.ReactNode; // Diz ao TypeScript que este componente recebe conteúdo.
}

// 2. A função agora recebe 'children' e o renderiza dentro do botão.
const MainButton: React.FC<MainButtonProps> = ({ variant = "primary", className, children, ...props }) => {
  return (
    <button
      className={clsx(
        "px-10 py-4 rounded-lg shadow-md transition-all duration-300 font-semibold focus:ring-4 text-base sm:text-lg",
        variant === "primary"
          ? "bg-yellow-500 hover:bg-yellow-400 text-black focus:ring-yellow-300"
          : "bg-neutral-900 hover:bg-gray-800 text-yellow-400 focus:ring-gray-600",
        className
      )}
      {...props}
    >
      {children}
    </button>
  );
};

export default MainButton;


---- end of file ----

==== C:\dev\AMS_HoldCrypto\frontend\src\shared\components\Modal.tsx ====
"use client";
import React from 'react';
import { Modal as MuiModal, Box, IconButton, Typography, Backdrop } from '@mui/material';
import { motion, AnimatePresence } from 'framer-motion';
import { X } from 'lucide-react';

interface ModalProps {
  open: boolean;
  onClose: () => void;
  title: string;
  children: React.ReactNode;
}

const modalVariants = {
  hidden: { opacity: 0, scale: 0.95, y: -20 },
  visible: { opacity: 1, scale: 1, y: 0 },
  exit: { opacity: 0, scale: 0.95, y: 20 },
};

const Modal: React.FC<ModalProps> = ({ open, onClose, title, children }) => {
  return (
    <AnimatePresence>
      {open && (
        <MuiModal
          open={open}
          onClose={onClose}
          closeAfterTransition
          slots={{ backdrop: Backdrop }}
          slotProps={{
            backdrop: {
              timeout: 500,
            },
          }}
        >
          <motion.div
            variants={modalVariants}
            initial="hidden"
            animate="visible"
            exit="exit"
            transition={{ type: 'spring', stiffness: 300, damping: 30 }}
          >
            <Box
              sx={{
                position: 'absolute',
                top: '50%',
                left: '50%',
                transform: 'translate(-50%, -50%)',
                width: { xs: '90%', sm: 500 },
                bgcolor: '#1E1E1E',
                border: '1px solid #333',
                borderRadius: 4,
                boxShadow: 24,
                display: 'flex',
                flexDirection: 'column',
              }}
            >
              {/* Modal Header */}
              <Box sx={{ p: 2, display: 'flex', justifyContent: 'space-between', alignItems: 'center', borderBottom: '1px solid #333' }}>
                <Typography variant="h6" component="h2" fontWeight="bold">
                  {title}
                </Typography>
                <IconButton onClick={onClose}>
                  <X size={20} />
                </IconButton>
              </Box>

              {/* Modal Content */}
              <Box sx={{ p: 3, overflowY: 'auto' }}>
                {children}
              </Box>
            </Box>
          </motion.div>
        </MuiModal>
      )}
    </AnimatePresence>
  );
};

export default Modal;

---- end of file ----

==== C:\dev\AMS_HoldCrypto\frontend\src\shared\components\NewsSection.tsx ====
'use client';
import React from 'react';
import Box from '@mui/material/Box';
import Typography from '@mui/material/Typography';
import Container from '@mui/material/Container';
import Grid from '@mui/material/Grid';
import Paper from '@mui/material/Paper';
import { useTheme } from '@mui/material/styles';

// Mantendo seus dados de notícias originais
const news = [
  {
    title: "Bitcoin atinge novo topo em 2025!",
    desc: "O mercado segue aquecido com alta demanda institucional."
  },
  {
    title: "Ethereum lança atualização Shanghai",
    desc: "Prometendo taxas menores e mais escalabilidade."
  },
  {
    title: "BNB Chain cresce em volume",
    desc: "Novos projetos DeFi impulsionam a rede."
  }
];

const NewsSection: React.FC = () => {
  const theme = useTheme();
  return (
    <Box
      sx={{
        py: { xs: 6, md: 10 },
        bgcolor: theme.palette.background.default, // Fundo principal escuro
      }}
      component="section"
    >
      <Container maxWidth="lg">
        <Typography 
          variant="h3" 
          component="h2" 
          textAlign="center" 
          fontWeight="bold" 
          sx={{ mb: 6 }}
        >
          Fique por Dentro das <span style={{ color: theme.palette.primary.main }}>Últimas Notícias</span>
        </Typography>
        <Grid container spacing={4}>
          {news.map((item, i) => (
            <Grid item xs={12} md={4} key={i}>
              <Paper
                elevation={0}
                sx={{
                  p: 3,
                  bgcolor: theme.palette.background.paper,
                  border: `1px solid ${theme.palette.divider}`,
                  borderRadius: 4,
                  height: '100%',
                }}
              >
                <Typography variant="h6" component="h3" fontWeight="bold" color="primary.main" gutterBottom>
                  {item.title}
                </Typography>
                <Typography variant="body2" color="text.secondary">
                  {item.desc}
                </Typography>
              </Paper>
            </Grid>
          ))}
        </Grid>
      </Container>
    </Box>
  );
};

export default NewsSection;



---- end of file ----

==== C:\dev\AMS_HoldCrypto\frontend\src\shared\components\NotificationToast.tsx ====
"use client";

import React from 'react';
import { motion } from 'framer-motion';
import { Alert, AlertTitle, IconButton, Box } from '@mui/material';
import { CheckCircle, XCircle, X } from 'lucide-react';

export type NotificationType = 'success' | 'error';

interface NotificationToastProps {
  message: string;
  type: NotificationType;
  onClose: () => void;
}

const toastVariants = {
  hidden: { opacity: 0, x: 100 },
  visible: { opacity: 1, x: 0 },
  exit: { opacity: 0, x: 100 },
};

const icons = {
  success: <CheckCircle color="currentColor" />,
  error: <XCircle color="currentColor" />,
};

const NotificationToast: React.FC<NotificationToastProps> = ({ message, type, onClose }) => {
  const title = type === 'success' ? 'Sucesso' : 'Erro';

  return (
    <motion.div
      variants={toastVariants}
      initial="hidden"
      animate="visible"
      exit="exit"
      layout
    >
      <Alert
        severity={type}
        icon={icons[type]}
        action={
          <IconButton color="inherit" size="small" onClick={onClose}>
            <X size={18} />
          </IconButton>
        }
        sx={{
          width: '100%',
          boxShadow: 6,
          borderRadius: 2,
          '& .MuiAlert-icon': {
            alignItems: 'center',
          },
        }}
      >
        <AlertTitle sx={{ fontWeight: 'bold' }}>{title}</AlertTitle>
        {message}
      </Alert>
    </motion.div>
  );
};

export default NotificationToast;

---- end of file ----

==== C:\dev\AMS_HoldCrypto\frontend\src\shared\context\NotificationContext.tsx ====
"use client";

import React, { createContext, useContext, useState, useCallback } from 'react';
import { AnimatePresence } from 'framer-motion';
import { Box } from '@mui/material';
import NotificationToast, { NotificationType } from '@/shared/components/NotificationToast';

interface Notification {
  id: number;
  message: string;
  type: NotificationType;
}

interface NotificationContextType {
  showNotification: (message: string, type: NotificationType) => void;
}

const NotificationContext = createContext<NotificationContextType | undefined>(undefined);

export const NotificationProvider: React.FC<{ children: React.ReactNode }> = ({ children }) => {
  const [notifications, setNotifications] = useState<Notification[]>([]);

  const removeNotification = useCallback((id: number) => {
    setNotifications((prev) => prev.filter((n) => n.id !== id));
  }, []);

  const showNotification = useCallback((message: string, type: NotificationType) => {
    const newNotification = {
      id: Date.now(),
      message,
      type,
    };
    setNotifications((prev) => [...prev, newNotification]);

    setTimeout(() => {
      removeNotification(newNotification.id);
    }, 5000); // A notificação desaparecerá após 5 segundos
  }, [removeNotification]);

  return (
    <NotificationContext.Provider value={{ showNotification }}>
      {children}
      <Box
        sx={{
          position: 'fixed',
          top: 80, // Abaixo do Header
          right: 16,
          zIndex: 1500, // Acima de outros elementos
          display: 'flex',
          flexDirection: 'column',
          gap: 1,
        }}
      >
        <AnimatePresence>
          {notifications.map((notification) => (
            <NotificationToast
              key={notification.id}
              message={notification.message}
              type={notification.type}
              onClose={() => removeNotification(notification.id)}
            />
          ))}
        </AnimatePresence>
      </Box>
    </NotificationContext.Provider>
  );
};

// Hook customizado para usar o contexto
export const useNotification = () => {
  const context = useContext(NotificationContext);
  if (context === undefined) {
    throw new Error('useNotification must be used within a NotificationProvider');
  }
  return context;
};

---- end of file ----

==== C:\dev\AMS_HoldCrypto\frontend\src\shared\theme\boxStyles.ts ====
export const yellowBorderBox = {
  borderRadius: "32px",
  border: "3px solid #fcd34d",
  background: "#18181b",
  color: "#fff",
  p: 3,
  boxShadow: 2,
};

export const authFormBox = {
  width: "100%",
  bgcolor: "#18181b",
  borderRadius: "32px",
  border: "3px solid #fcd34d",
  boxShadow: 4,
  p: { xs: 3, sm: 6 },
  color: "#fff",
  mt: 8,
};

export const crudTableBox = {
  borderRadius: "24px",
  border: "2px solid #fcd34d",
  background: "#23272f",
  color: "#fff",
  p: 3,
  boxShadow: 1,
  mt: 4,
};

---- end of file ----

==== C:\dev\AMS_HoldCrypto\frontend\src\shared\theme\fieldStyles.ts ====
export const yellowField = {
  input: { color: "#fff", bgcolor: "#23272f", borderRadius: 2 },
  label: { color: "#fcd34d" },
  "& .MuiOutlinedInput-root": {
    "& fieldset": { borderColor: "#fcd34d" },
    "&:hover fieldset": { borderColor: "#ffe066" },
    "&.Mui-focused fieldset": { borderColor: "#fcd34d" },
  },
};

---- end of file ----

==== C:\dev\AMS_HoldCrypto\frontend\src\shared\theme\theme.ts ====
import { createTheme } from "@mui/material/styles";
import { Inter } from "next/font/google";

export const inter = Inter({
  weight: ['300', '400', '500', '700'],
  subsets: ['latin'],
  display: 'swap',
});

// Este é o nosso novo tema centralizado, a "constituição" do design.
const theme = createTheme({
  palette: {
    mode: "dark",
    primary: { main: "#F0B90B" }, // Amarelo principal
    secondary: { main: "#ffe066" }, // Amarelo mais claro para hovers
    background: { 
      default: "#0B0B0B", // Preto profundo para fundos de página
      paper: "#1E1E1E"    // Cinza escuro para cards e elementos elevados
    },
    text: { 
      primary: "#FFFFFF",
      secondary: "#b0b0b0" 
    },
    divider: "#333333",
    success: { main: "#22c55e" },
    error: { main: "#ef4444" },
  },
  typography: {
    fontFamily: inter.style.fontFamily,
    h1: { fontWeight: 700 },
    h2: { fontWeight: 700 },
    h3: { fontWeight: 700 },
    h4: { fontWeight: 700 },
    h5: { fontWeight: 600 },
    h6: { fontWeight: 600 },
  },
  shape: {
    borderRadius: 12,
  },
  components: {
    MuiButton: {
      styleOverrides: {
        root: {
          fontWeight: "bold",
          textTransform: 'none',
          borderRadius: 8,
          padding: '10px 24px',
        },
        containedPrimary: {
          color: "#0B0B0B",
          '&:hover': {
            backgroundColor: "#ffe066",
          }
        },
      },
    },
    MuiPaper: {
        styleOverrides: {
            root: {
                backgroundImage: 'none', // Remove gradientes padrão do MUI em modo dark
            }
        }
    },
    MuiTextField: {
        styleOverrides: {
            root: {
                '& label.Mui-focused': {
                    color: '#F0B90B',
                },
                '& .MuiOutlinedInput-root': {
                    '& fieldset': {
                        borderColor: '#333333',
                    },
                    '&:hover fieldset': {
                        borderColor: '#F0B90B',
                    },
                    '&.Mui-focused fieldset': {
                        borderColor: '#F0B90B',
                    },
                },
            }
        }
    }
  },
});

export default theme;



---- end of file ----

==== C:\dev\AMS_HoldCrypto\frontend\src\shared\theme\ThemeProvider.tsx ====
// Caminho: frontend/src/shared/theme/ThemeProvider.tsx

'use client';
import { ThemeProvider as MuiThemeProvider, CssBaseline } from '@mui/material';
// Usando o caminho relativo para garantir que funcione
import theme from './theme'; 

export function ThemeProvider({ children }: { children: React.ReactNode }) {
  return (
    <MuiThemeProvider theme={theme}>
      <CssBaseline />
      {children}
    </MuiThemeProvider>
  );
}

---- end of file ----

